// app/assets/stylesheets/shared/_header.scss

// @use 'shared/common'; // TODO: SASS 4.0

//=============================================================================
// Page header.
//=============================================================================

// The <header> area of the page.
.layout-header {
    display:         flex;
    flex-direction:  column;
    justify-content: flex-start;
    margin:          0;
    padding:         0;
}

//=============================================================================
// Variables
//=============================================================================

// noinspection SassScssResolvedByNameOnly
$label-gap: $flex-gap-x / 2;

//=============================================================================
// Placeholder classes
//=============================================================================

// noinspection SassScssResolvedByNameOnly
%header-section {
    display:        flex;
    flex-direction: row;
    width:          100%;
}

// noinspection SassScssResolvedByNameOnly
%header-search-section {

    @extend %header-section;

    width:     33%;
    max-width: calc(#{$lg-width} - (2 * #{$page-padding-x}));

    @media #{$narrow-screen} {
        width:     100%;
        min-width: unset;
        max-width: unset;
    }
}

%color-black-inside {
    * { color: black; }
}

//=============================================================================
// Sections
//=============================================================================

// The content at the top of every page.
//
// noinspection SassScssResolvedByNameOnly
.layout-banner {

    @extend %banner;

    font-size: x-large;

    //=========================================================================
    // Sections
    //=========================================================================

    > * {
        display:        flex;
        flex-direction: row;
        flex:           0 1 auto;
    }

    // The logo (home link) and tagline on the left-hand side of the header.
    .logo-area {

        justify-content: flex-start;
        margin-top:      0;
        flex:            0 1 auto;

        > * {
            margin: auto $flex-gap-x auto 0;
        }

        @media #{$narrow-screen} {

            flex-direction: column;

            > * {
                margin: $flex-gap-y 0 0;
            }
        }
    }

    // Action controls on the right-hand side of the header, particularly the
    // "Sign in"/"Sign out" button, which appears in the upper-right corner of
    // the display regardless of the width of the display.
    .control-area {

        flex-wrap:       wrap-reverse;
        justify-content: flex-end;
        margin-top:      auto;
        overflow:        hidden;
        flex:            1 1 auto;

        > * {
            margin: auto 0 auto $flex-gap-x;
        }

        @media #{$narrow-screen} {

            flex-direction: column-reverse;
            margin-top:     0;
            margin-bottom:  $flex-gap-y;

            > * {
                margin: $flex-gap-y 0 0;
            }
        }
    }

    //=========================================================================
    // Elements
    //=========================================================================

    // The fixed-size EMMA logo element.
    .logo {
        margin-top: 0;
        font-size:  xx-large;
        flex:       0 0 auto;
    }

    // The EMMA tagline next to the logo.
    //
    // This is reformatted to fit within the available display width, and is
    // not shown at all on small (narrow) displays due to insufficient screen
    // real estate.
    //
    .tagline {

        font-size:    smaller;
        font-variant: small-caps;
        flex:         0 1 auto;

        @media #{$browser-ie} {
            margin-top: 0.5rem;
        }

        @media #{$medium-width} {
            font-size: small;
        }

        @media #{$narrow-screen} {
            display: none;
        }
    }

    // The name of the signed-in user.
    //
    // This is truncated with ellipses in cases where the display width is not
    // sufficient to show the whole name.
    //
    .user {
        width:         min-content;
        max-width:     100%;
        font-size:     smaller;
        overflow:      hidden;
        text-overflow: ellipsis;
        flex:          0 1 auto;
    }

    // The "Sign in"/"Sign out" button.
    //
    // This always appears in the upper-right corner of the display due to the
    // .content-area settings.
    //
    .session {

        min-width:     max-content;
        max-width:     max-content;
        padding:       0.25rem 0.375rem;
        border:        1px solid;
        border-radius: 0.5rem;
        flex:          0 0 auto;

        @media #{$narrow-screen} {
            margin-top: $flex-gap-y;
        }
    }

    // Sign-in button link element.
    .session-link:focus {
        outline-offset: 1px;
    }
}

// Navigation bar (<nav>) at the top of every page just below the top banner.
//
// noinspection SassScssResolvedByNameOnly
.layout-navbar {

    @extend %banner;

    // TODO: prefer hamburger menu for small screens?
    @media #{$narrow-screen} {
        flex-direction: column;
    }

    //=========================================================================
    // Sections
    //=========================================================================

    .links {

        @extend %header-section;

        flex-wrap: wrap;
        font-size: x-large;

        > * {
            width:        max-content;
            margin-right: 0.5rem;
        }

        a:active {
            outline: 2px dotted white;
        }

        .active {
            text-decoration: underline;
        }
    }
}

// Search input bar.
// Search controls (sort, per-page, language).
//
// noinspection SassScssResolvedByNameOnly
.layout-section {

    @extend %banner;

    padding-top: 0;

    //=========================================================================
    // Sections
    //=========================================================================

    .search-bar {

        @extend %header-search-section;
        @extend %color-black-inside;

        .search-input {
            flex: 1 1 auto;
        }

        .search-button {
            margin-left: $label-gap;
            flex:        0 0 auto;
        }
    }

    .search-controls {

        @extend %header-search-section;

        display:               grid;
        grid-template-columns: auto;
        grid-template-rows:    [sort] auto [limit] auto [language] auto;
        width:                 100%;

        @media #{$wide-screen} {

            grid-template-columns: [sort] 1fr [limit] 1fr [language] 1fr;
            grid-template-rows:    auto;
            width:                 auto;

            @media #{$browser-ie} {
                width: 50%;
            }
        }

        //=====================================================================
        // Sections
        //=====================================================================

        .menu-container {

            display:               grid;
            grid-template-columns: [label] 0.25fr [control] 1fr;
            margin:                ($flex-gap-y / 2) 0;

            @media #{$browser-ie} {
                display:        flex;
                flex-direction: row;
            }

            @media #{$wide-screen} {

                grid-template-columns: [label] auto [control] 1fr;
                margin:                auto;

                &:first-of-type { margin-left: 0; }
            }
        }

        //=====================================================================
        // Elements
        //=====================================================================

        .menu-label {

            margin: 0;

            @media #{$wide-screen} {
                margin-right: $label-gap;
            }
        }

        .menu-control {
            @extend %color-black-inside;
        }
    }
}
