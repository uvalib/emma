// app/assets/stylesheets/controllers/_title.scss

// @use 'shared/common';  // TODO: SASS 4.0
// @use 'shared/mixins';  // TODO: SASS 4.0
// @use 'feature/search'; // TODO: SASS 4.0

//=============================================================================
// Catalog Title index page
//=============================================================================

// noinspection SassScssResolvedByNameOnly
.title-list {

    @extend .results-list;
    @extend .list-3-column;

    justify-items: stretch;

    //=========================================================================
    // Classes
    //=========================================================================

    .number {
        // Push item number to the right and hide.
        @media #{$narrow-screen} {
            grid-column: 3 / -1;
            visibility:  hidden;
        }
    }

    // @see TitleHelper#thumbnail
    .thumbnail {

        @extend %thumbnail-dimensions;

        margin-bottom: $results-entry-gap-y;

        @media #{$browser-ie} {
            margin-bottom: $ie-results-entry-gap-y;
        }

        // Push thumbnail to the right and occupy the right side of the entry.
        @media #{$narrow-screen} {
            grid-column: 3 / -1;
            grid-row:    span 2;
        }
    }
}

// noinspection SassScssResolvedByNameOnly
.title-list-entry {

    @extend .list-entry;

    grid-auto-rows: min-content;

    //=========================================================================
    // Classes
    //=========================================================================

    .label {
        &.field-Title {
            @media #{$narrow-screen} {
                display: none;
            }
        }
    }

    .value {

        a + a {

            margin-left: $gap-x;

            @media #{$browser-ie} {
                margin-left: $ie-gap-x;
            }
        }

        &.field-Title {

            font-weight: bold;

            @media #{$narrow-screen} {
                grid-column: 1 / -1;
            }

            a:not(:hover) {
                text-decoration: none;
            }
        }

        &.field-Authors {
            @media #{$narrow-screen} {

                display:        flex;
                flex-direction: column;
                line-height:    1.5;

                a {
                    margin-left:   0;
                }

                a + a {
                    margin-top: 0.5rem;
                }
            }
        }

        &.field-None {
            margin-bottom: 0;
        }
    }
}

//=============================================================================
// Catalog Title show page
//=============================================================================

// noinspection SassScssResolvedByNameOnly
.title-details {

    @extend .details-entry;

    .value {

        @include width-fit-content(90%);

        display:        flex;
        flex-direction: column;

        $click-target-gap-y: 0.375rem;

        > * {

            @include width-fit-content;

            margin-bottom: $click-target-gap-y;

            &:last-child {
                margin-bottom: 0;
            }
        }

        a + a {
            margin-top: $click-target-gap-y;
        }

        &.field-Synopsis {

            margin-bottom: calc(#{$results-entry-gap-y} / 2);

            @media #{$browser-ie} {
                margin-bottom: ($ie-results-entry-gap-y / 2);
            }
        }

        &.field-Categories {
            a + a {
                &:last-of-type + span {
                    margin-top: $click-target-gap-y;
                }
            }
        }

        &.field-Countries {

            display:     block;
            font-family: monospace;
            font-size:   larger;

            > * {
                margin-bottom: 0;
            }
        }

        &.field-Formats {
            .artifact + .artifact {
                margin-top: $click-target-gap-y;
            }
        }

        // noinspection CssOverwrittenProperties
        &.field-Links {
            word-break: break-all;
            word-break: break-word;
        }
    }
}

// Wrapper for .title-details which displays the full-size cover image to the
// right on large screens.
//
// noinspection SassScssResolvedByNameOnly
.title-details-container {

    // Making this "display: flex" results in the cover image always showing up
    // at the top of the second column (and is crucial for avoiding occasional
    // inconsistencies in Firefox).
    @media #{$wide-screen} {

        display:      flex;
        column-count: 2;
        margin-top:   $page-padding;

        // Making this "flex: 1 1" seems to be required for MS IE11 to make
        // room for the cover image; it's disastrous for other browsers.
        @media #{$browser-ie} {
            .title-details {
                flex: 1 1;
            };
        }
    }

    // @see TitleHelper#cover_image
    .cover-image {

        // Reserve width to avoid watching the page re-layout if a cover image
        // is acquired asynchronously.
        @media #{$wide-screen} {

            min-width:   $nominal-cover-x;
            margin-left: $results-entry-gap-x;

            @media #{$browser-ie} {
                margin-left: $ie-results-entry-gap-x;
            }
        }

        @media #{$medium-width} {
            min-width: unset;
            max-width: $nominal-cover-x;
        }

        @media #{$narrow-screen} {
            min-width: unset;
            max-width: 100%;
        }

        img:not(.placeholder) {
            width: 100%;
        }
    }
}
