// app/assets/stylesheets/feature/_search.scss

// @use 'feature/model'; // TODO: SASS 4.0

//=============================================================================
// Search controls
//=============================================================================

// noinspection SassScssResolvedByNameOnly
.pagination-top,
.pagination-bottom,
.applied-search-terms {

    @include grid-column-span(3);

    margin: $results-entry-gap-y 0;

    @media #{$narrow-screen} {
        margin: calc(2 * #{$results-entry-gap-y}) 0;
    }

    @media #{$browser-ie} {

        margin: $ie-results-entry-gap-y 0;

        @media #{$narrow-screen} {
            margin: (2 * $ie-results-entry-gap-y) 0;
        }
    }
}

.pagination-bottom {

    margin-top: 0;

    // noinspection SassScssResolvedByNameOnly
    @media #{$browser-ie} {
        -ms-grid-row: 999;
    }
}

.applied-search-terms.invisible {
    margin-top: 0;
}

.applied-search-terms + .pagination-top {
    margin-top: 0;
}

// A total count of the number of search results.
.search-count {
    display: inline-block;
    margin:  0.5rem 0 0 0.5rem;
}

//=============================================================================
// Search terms
//=============================================================================

// Search term(s) applied which yield the current result set.
//
// noinspection SassScssResolvedByNameOnly
.search-terms {

    @extend %control-group;

    flex-wrap:        wrap;
    padding-bottom:   0;
    background-color: inherit;

    //=========================================================================
    // Components
    //=========================================================================

    $term-gap-x: 1rem;
    $term-gap-y: $term-gap-x / 2;

    > * {
        margin-bottom: $term-gap-y;
        align-items:   center;
    }

    // Displayed before the list of search terms and facet selections.
    .label {

        margin-top:   $term-gap-y / 2;
        margin-right: $term-gap-x;
        font-size:    large;
        font-weight:  bold;

        // Don't add extra space if there are only search terms with no
        // facet selections.
        &.query {
            margin-right: 0;
        }
    }

    // A search term or a facet selection label/value pair.
    .term {

        //=====================================================================
        // Components
        //=====================================================================

        .field {
            font-size:    large;
            font-variant: small-caps;
        }

        .separator {
            font-weight:  bold;
        }

        .value {
            margin-left:  $term-gap-x / 2;
        }

        //=====================================================================
        // Variations
        //=====================================================================

        // A term containing one or more text values.
        &.query {
            .value {
                font-size: larger;
            }
        }

        // A facet selection label/value pair.
        &.facet {
            // TODO: ???
        }
    }

    // A visible break between terms/facet selections.
    .term-separator {
        margin-top:   auto;
        margin-right: $term-gap-x / 2;
        margin-left:  $term-gap-x / 2;
        font-size:    larger;
        color:        $panel-accent;
    }

    // Add extra space between the last textual search term and the first
    // facet value selection.
    .term.query + .term,
    .term.query + .term-separator {
        margin-left: 3 * $term-gap-x / 2;
    }

    //=========================================================================
    // Elements
    //=========================================================================

    // Text formatted as a "badge" inside a .value.
    .badge {

        display:         flex;
        flex-direction:  row;
        justify-content: space-between;
        align-items:     center;
        padding:         2px 6px;
        line-height:     1;
        background:      whitesmoke;
        border:          1px solid $uva-accent-blue;
        border-radius:   0.25rem;
        background:      $focus-accent;

        // Facet selection value.
        .text {
            flex: 1 1 auto;
        }

        // Control for eliminating the facet value selection from the search.
        .control {
            @include clear-selection-button;
        }
    }

    //=========================================================================
    // Variations
    //=========================================================================

    @media #{$narrow-screen} {

        flex-direction: column;
        width:          92.5%;

        .label {
            margin-right: 0;
        }

        .term {

            flex-wrap: wrap;

            .field {
                flex: 1 0 100%;
            }

            .separator {
                display: none;
            }

            .value {
                margin-left: 0;
            }
        }

        .term-separator {
            display: none;
        }

        .badge {
            .text {
                min-width:   70vw;
                word-break:  break-all;
            }
            .control {
                margin-left: auto;
            }
        }
    }
}
