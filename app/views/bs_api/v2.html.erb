<%# app/views/bs_api/v2.html.erb -%>
<%-
  # Display of results from an individual API call.

  view_debug(__FILE__)

  result ||= @api_result || {}

  help   ||= nil # %i[bs_api v2]
  title  ||= t('emma.bs_api.v2.title')

  unless modal?
    set_page_meta_title(title, result[:url].inspect)
    set_page_description(title)
  end

  result, info = partition_hash(result, :exception, :result)

-%>

<%= page_heading(title, help: help) %>

<div class="session-debug">
  <table>
    <tbody>
      <%- info.each_pair do |k, v| -%>
        <tr>
          <th class="key"><%= k -%></th>
          <td class="value"><%= v.is_a?(String) ? v : v.inspect -%></td>
        </tr>
      <%- end -%>
    </tbody>
  </table>
</div>

<div class="trials">
  <div class="value">
    <%= format_api_result(result.values.first) %>
  </div>
</div>
