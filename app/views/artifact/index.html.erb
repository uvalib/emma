<%# app/views/artifact/index.html.erb -%>
<%-
  abort 'artifact/index - This is not expected to be used'

  # Artifact index.
  title ||= t('emma.artifact.index.title')

  item_list = artifact_list.presence

  if item_list
    all_count    = nil
    search_count = "#{total_items} items found." # TODO: I18n
    search_count = content_tag(:div, search_count, class: 'search-count')
    controls     = pagination_controls
    terms        = search_terms.presence
  else
    all_count    = " (#{total_items})"
    search_count = controls = terms = nil
  end

  set_page_title(t('emma.artifact.index.label', default: title))
  append_page_title('-', hash_string(terms)) if terms.present?
  set_page_description(title)
  set_page_robots(:noindex, :nofollow)
-%>

<h1 class="heading"><%= title -%><%= all_count -%></h1>

<div class="artifact-list">

  <%# === Applied search terms (when applicable) === -%>
  <%= applied_search_terms(terms) if terms.present? %>

  <%# === Top pagination controls === -%>
  <%- if controls -%>
    <div class="pagination-top"><%= controls -%><%= search_count -%></div>
  <%- end -%>

  <%# === Items === -%>
  <%- if item_list -%>
    <%- item_list.each_with_index do |item, idx| -%>
      <%= render 'artifact/entry', index: idx, item: item %>
    <%- end -%>
  <%- else -%>
    <%= render 'artifact/entry', index: -1 %>
  <%- end -%>

  <%# === Bottom pagination controls === -%>
  <%- if controls -%>
    <div class="pagination-bottom"><%= controls -%></div>
  <%- end -%>

</div>
