<%# app/views/sys/files.html.erb -%>
<%-
  # Host system disk space.

  view_debug(__FILE__)

  help  ||= nil # %i[sys files]
  title ||= t('emma.sys.files.title')

  unless modal?
    label = t('emma.sys.files.label', default: title)
    set_page_meta_title("System - #{label}")
    set_page_description(title)
  end

  # Root directories that will not be included in the recursive listing.
  ignore  = %w[.git node_modules tmp]
  ignore += %w[.gem_rbs_collection .idea sig] if not_deployed?
  ignore  = ignore.join("\n")

  names   = '.[^.]* *'
  dirs    = `ls -dv #{names} | fgrep -v -x "#{ignore}"`.squish
  ls_opt  = 'hlp'

  command = [
    "ls -dv#{ls_opt} #{names}",                 # In place of root-level lines.
    'echo',
    "ls -ARv#{ls_opt} #{dirs} | sed '1,/^$/d'"  # Skip root-level output lines.
  ].join(";\n")

-%>

<%= scroll_to_top_target %>
<%= page_heading(title, help: help) %>
<%= page_description_section %>

<%= page_directions_section %>

<%= render 'sys/command', command: command %>

<%= page_notes_section %>
<%= render 'sys/menu' unless modal? %>
