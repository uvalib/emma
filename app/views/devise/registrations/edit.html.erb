<%# app/views/devise/registrations/new.html.erb -%>
<%-
  # Edit User page.
  title ||= t('emma.user.registrations.edit.label')

  form_opt = {
    as:   resource_name,
    url:  registration_path(resource_name),
    html: { method: :put }
  }
  awaiting =
    if devise_mapping.confirmable? && (email = resource.unconfirmed_email)
      t('emma.user.registrations.edit.awaiting', email: email)
    end
  pwd_note      = t('emma.user.registrations.edit.password')
  min_length    = @minimum_password_length
  min_length  &&= t('emma.user.password.length', min: min_length)
  curr_pwd_note = t('emma.user.registrations.edit.current')
  submit_label  = t('emma.user.registrations.edit.submit')

  cancel_label = t('emma.user.registrations.destroy.label')
  cancel_link =
    button_to(
      cancel_label,
      registration_path(resource_name),
      method: :delete,
      data:   { confirm: t('emma.label.confirm') }
    )
  cancel_link =
    t('emma.user.registrations.destroy.link', button: cancel_link).html_safe

  back_link = link_to(t('emma.label.back'), :back)

  set_page_title(title)
  set_page_description(title)
  set_page_robots(:noindex, :nofollow)
-%>

<h1 class="heading"><%= title -%></h1>

<%= form_for(resource, form_opt) do |f| %>

  <%= render 'devise/shared/error_messages', resource: resource %>

  <div class="field">
    <%= f.label       :email %><br />
    <%= f.email_field :email, autofocus: true, autocomplete: 'email' %>
  </div>

  <%- if awaiting -%>
    <div><%= awaiting -%></div>
  <%- end -%>

  <div class="field">
    <%= f.label :password -%> <i>(<%= pwd_note -%>)</i><br/>
    <%= f.password_field :password, autocomplete: 'new-password' %>
    <%- if min_length -%>
      <br/>
      <em><%= min_length -%></em>
    <%- end -%>
  </div>

  <div class="field">
    <%= f.label          :password_confirmation %><br/>
    <%= f.password_field :password_confirmation, autocomplete: 'new-password' %>
  </div>

  <div class="field">
    <%= f.label :current_password -%> <i>(<%= curr_pwd_note -%>)</i><br/>
    <%= f.password_field :current_password, autocomplete: 'current-password' %>
  </div>

  <div class="actions">
    <%= f.submit submit_label %>
  </div>

<%- end -%>

<h3><%= cancel_label -%></h3>

<p><%= cancel_link -%></p>

<%= back_link %>

<%-
  abort 'devise/registrations/edit - This is not expected to be used'
-%>
