<%# app/views/member/_details.html.erb -%>
<%-
  # A Member metadata listing with preferences and history.

  view_debug(__FILE__)

  item  ||= nil
  pref  ||= nil
  hist  ||= nil
  dec   ||= item && MemberDecorator.new(item, hist: hist, pref: pref, **context) or return
  pref  ||= dec.preference_data
  hist  ||= dec.history_data

  level ||= 1
  extra ||= nil
  skip  ||= nil

  skip    = [*skip]
  pref    = nil if skip.include?(:preferences)
  hist    = nil if skip.include?(:history)
  heading =
    if (level == 1) && !skip.include?(:title)
      title ||= 'Bookshare Account Details' # TODO: I18n
      html_tag((level + 1), title, class: 'account list-heading')
    end

  opt = { dec: dec, level: (level + 1), skip: skip }

-%>

<%= heading %>

<%= dec.details_container(level: level, pairs: extra, skip: skip) do %>
  <%= render 'member/preferences', opt if pref %>
<%- end -%>

<%= render 'member/history', opt if hist %>
