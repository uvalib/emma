<%# app/views/help/_list.html.erb -%>
<%-
  # A sequence of help entries.

  list   ||= []
  level  ||= 1
  row    ||= level
  skip   ||= nil

  skip = Array.wrap(skip)
  heading =
    unless skip.include?(:title)
      title ||= t('emma.help.index.title')
      classes = 'list-heading'
      classes = css_classes(classes, 'empty') if list.blank?
      html_tag(level, h(title), class: classes)
    end

  level += 1
  index = 0
  sub_heading =
    help_titles(*list).map { |topic, label|
      classes = "entry-title row-#{index}"
      index += 1
      html_tag(level, label, class: classes, id: "#{topic}_help")
    }

  skip = [*skip, :title].uniq
  opt  = { level: level, skip: skip }

-%>

<%= heading %>

<%- if list.blank? -%>
  <%= render 'help/entry', opt.merge!(index: -1, row: row) %>
<%- else -%>
  <%- list.each_with_index do |item, idx| -%>
    <%= sub_heading[idx] %>
    <div class="help-list-entry <%= "row-#{idx}"-%>">
      <%- opt.merge!(index: idx, row: (row + idx), item: item) -%>
      <%= render 'help/entry', opt %>
    </div>
  <%- end -%>
<%- end -%>
