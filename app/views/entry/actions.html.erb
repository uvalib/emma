<%# app/views/entry/actions.html.erb -%>
<%-
  # Display a list of Action records.

  view_debug(__FILE__)

  list  ||= paginator.page_items
  dec     = ActionsDecorator.new(list, **context)

  help   ||= nil # %i[entry actions]
  title  ||= nil
  title    = dec.page_heading(title)

  count  ||= list.size
  offset ||= @page.page_offset
  level  ||= 1
  row    ||= level
  skip   ||= nil

  total  ||= count
  terms  ||= search_terms

  page_opt = Entry::SEARCH_RECORDS_OPTIONS.dup << :group
  page_terms, search = partition_hash(terms, *page_opt)
  page     = positive(page_terms[:page]&.values&.first) || 1
  search   = search.presence

  unless modal?
    label = dec.page_meta_title
    terms = (page > 1) ? search&.merge(page: page_terms[:page]) : search
    group = page_terms[:group]&.values&.first
    group = Entry.state_group_label(group)                if group
    set_page_meta_title(label)
    append_page_meta_title('-', group)                    if group
    append_page_meta_title('-', list_search_terms(terms)) if terms
    set_page_description(title)
  end

  level += 1

  opt = { total: total, page: page, row: row, offset: offset, level: level }

  top_controls, bottom_controls = dec.index_controls(**opt)
  opt[:row] += 1        if top_controls
  bottom_controls = nil if list.blank?

-%>

<%= page_heading(title, help: help) %>

<%#= dec.list_filter_options if session_debug? %>
<%#= page_description_section %>
<%#= dec.state_group_select %>

<div class="<%= dec.css_list_class -%>">
  <%= top_controls %>
  <%= dec.render(skip: skip, **opt) %>
  <%= bottom_controls %>
</div>
