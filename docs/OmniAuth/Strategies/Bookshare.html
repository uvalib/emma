<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: OmniAuth::Strategies::Bookshare

    &mdash; Documentation by YARD 0.9.26

</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "OmniAuth::Strategies::Bookshare";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">

    <a href="../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Strategies.html" title="OmniAuth::Strategies (module)">Strategies</a></span></span>
     &raquo;
    <span class="title">Bookshare</span>

</div>

        <div id="search">

    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>

</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: OmniAuth::Strategies::Bookshare



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">OAuth2</span>

        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>

            <li class="next">OAuth2</li>

            <li class="next">OmniAuth::Strategies::Bookshare</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>






  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../../Emma/Debug.html" title="Emma::Debug (module)">Emma::Debug</a></span>, <span class='object_link'><a href="../../Emma/Json.html" title="Emma::Json (module)">Emma::Json</a></span></dd>
  </dl>






  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb</dd>
  </dl>

</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">

<p>An extension of OmniAuth::Strategies::OAuth2 which sets up some defaults that would otherwise have to be specified in initializers/devise.rb.</p>

<p>â€“ noinspection LongLine ++</p>


  </div>
</div>
<div class="tags">


  <p class="tag_title">See Also:</p>
  <ul class="see">

      <li><a href="https://github.com/omniauth/omniauth-oauth2" target="_parent" title="https://github.com/omniauth/omniauth-oauth2">https://github.com/omniauth/omniauth-oauth2</a></li>

  </ul>

</div>

    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">

        <dt id="CONFIGURED_AUTH-constant" class="">CONFIGURED_AUTH =
          <div class="docstring">
  <div class="discussion">

<p>A table of pre-authorized user/token pairs for development purposes.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Type:</p>
<ul class="type">

    <li>





        <div class='inline'><dl class="rdoc-list label-list"><dt>HashString=&gt;String
<dd></dd></dl>
</div>

    </li>

</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='id identifier rubyid_reject_blanks'>reject_blanks</span><span class='lparen'>(</span><span class='id identifier rubyid_safe_json_parse'>safe_json_parse</span><span class='lparen'>(</span><span class='const'>BOOKSHARE_TEST_USERS</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_entries'>entries</span><span class='op'>|</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rails_application?'>rails_application?</span>
    <span class='id identifier rubyid_users'>users</span>  <span class='op'>=</span> <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
    <span class='id identifier rubyid_tokens'>tokens</span> <span class='op'>=</span> <span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='lbrace'>{</span> <span class='label'>access_token:</span> <span class='id identifier rubyid_v'>v</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
    <span class='const'><span class='object_link'><a href="../../User.html" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_users'>users</span><span class='comma'>,</span> <span class='id identifier rubyid_tokens'>tokens</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_deep_freeze'>deep_freeze</span></pre></dd>

    </dl>






  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../../Emma/Debug.html" title="Emma::Debug (module)">Emma::Debug</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Emma/Debug.html#DEBUG_SEPARATOR-constant" title="Emma::Debug::DEBUG_SEPARATOR (constant)">Emma::Debug::DEBUG_SEPARATOR</a></span></p>



  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../../Emma/Common.html" title="Emma::Common (module)">Emma::Common</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Emma/Common.html#BOOLEAN_VALUES-constant" title="Emma::Common::BOOLEAN_VALUES (constant)">Emma::Common::BOOLEAN_VALUES</a></span>, <span class='object_link'><a href="../../Emma/Common.html#HTML_QUOTES-constant" title="Emma::Common::HTML_QUOTES (constant)">Emma::Common::HTML_QUOTES</a></span>, <span class='object_link'><a href="../../Emma/Common.html#INFLECT_PLURAL-constant" title="Emma::Common::INFLECT_PLURAL (constant)">Emma::Common::INFLECT_PLURAL</a></span>, <span class='object_link'><a href="../../Emma/Common.html#INFLECT_SINGULAR-constant" title="Emma::Common::INFLECT_SINGULAR (constant)">Emma::Common::INFLECT_SINGULAR</a></span>, <span class='object_link'><a href="../../Emma/Common.html#LIST_SEPARATOR-constant" title="Emma::Common::LIST_SEPARATOR (constant)">Emma::Common::LIST_SEPARATOR</a></span>, <span class='object_link'><a href="../../Emma/Common.html#PAIR_SEPARATOR-constant" title="Emma::Common::PAIR_SEPARATOR (constant)">Emma::Common::PAIR_SEPARATOR</a></span>, <span class='object_link'><a href="../../Emma/Common.html#QUOTE_MARKS-constant" title="Emma::Common::QUOTE_MARKS (constant)">Emma::Common::QUOTE_MARKS</a></span></p>






    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#normalize_parameters-class_method" title="normalize_parameters (class method)">.<strong>normalize_parameters</strong>(params)  &#x21d2; Hash{Symbol=&gt;*} </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>normalize_parameters.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#stored_auth-class_method" title="stored_auth (class method)">.<strong>stored_auth</strong>(refresh = false)  &#x21d2; Hash{String=&gt;Hash} </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Table of user names/tokens acquired for use in non-production deploys.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#stored_auth_entry-class_method" title="stored_auth_entry (class method)">.<strong>stored_auth_entry</strong>(token)  &#x21d2; Hash{Symbol=&gt;String} </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Produce a stored_auth table entry value.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#stored_auth_update-class_method" title="stored_auth_update (class method)">.<strong>stored_auth_update</strong>(uid, token = nil)  &#x21d2; Hash{String=&gt;Hash} </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Add or update a user name/token entry.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#synthetic_auth_hash-class_method" title="synthetic_auth_hash (class method)">.<strong>synthetic_auth_hash</strong>(id, token = nil)  &#x21d2; OmniAuth::AuthHash<sup>?</sup> </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Generate an auth hash based on fixed information.</p>
</div></span>

</li>


    </ul>

    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#authorize_params-instance_method" title="#authorize_params (instance method)">#<strong>authorize_params</strong>  &#x21d2; Hash </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>authorize_params.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#call_app!-instance_method" title="#call_app! (instance method)">#<strong>call_app!</strong>(env = @env)  &#x21d2; * </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>call_app!.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#callback_call-instance_method" title="#callback_call (instance method)">#<strong>callback_call</strong>  &#x21d2; Object </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Performs the steps necessary to run the callback phase of a strategy.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#callback_phase-instance_method" title="#callback_phase (instance method)">#<strong>callback_phase</strong>  &#x21d2; (Integer, Rack::Utils::HeaderHash, Rack::BodyProxy) </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>callback_phase.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#client-instance_method" title="#client (instance method)">#<strong>client</strong>  &#x21d2; ::OAuth2::Client </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>The OAuth2 client instance.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#log-instance_method" title="#log (instance method)">#<strong>log</strong>(level, message)  &#x21d2; Object </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Direct access to the OmniAuth logger, automatically prefixed with this strategy&#39;s name.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#raw_info-instance_method" title="#raw_info (instance method)">#<strong>raw_info</strong>  &#x21d2; Hash{Symbol=&gt;Object} </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Information about the user account.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#request_call-instance_method" title="#request_call (instance method)">#<strong>request_call</strong>  &#x21d2; (Integer, Rack::Utils::HeaderHash, Rack::BodyProxy) </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>Performs the steps necessary to run the request phase of a strategy.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#request_phase-instance_method" title="#request_phase (instance method)">#<strong>request_phase</strong>  &#x21d2; (Integer, Rack::Utils::HeaderHash, Rack::BodyProxy) </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>request_phase.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#token_params-instance_method" title="#token_params (instance method)">#<strong>token_params</strong>  &#x21d2; Hash </a>



  </span>









    <span class="summary_desc"><div class='inline'>
<p>token_params.</p>
</div></span>

</li>


    </ul>











  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Emma/Debug.html" title="Emma::Debug (module)">Emma::Debug</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Emma/Debug.html#__debug_args-instance_method" title="Emma::Debug#__debug_args (method)">#__debug_args</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_env_hash-instance_method" title="Emma::Debug#__debug_env_hash (method)">#__debug_env_hash</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_exception-instance_method" title="Emma::Debug#__debug_exception (method)">#__debug_exception</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_header_hash-instance_method" title="Emma::Debug#__debug_header_hash (method)">#__debug_header_hash</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_items-instance_method" title="Emma::Debug#__debug_items (method)">#__debug_items</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_label-instance_method" title="Emma::Debug#__debug_label (method)">#__debug_label</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_line-instance_method" title="Emma::Debug#__debug_line (method)">#__debug_line</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_request-instance_method" title="Emma::Debug#__debug_request (method)">#__debug_request</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_route-instance_method" title="Emma::Debug#__debug_route (method)">#__debug_route</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_route_label-instance_method" title="Emma::Debug#__debug_route_label (method)">#__debug_route_label</a></span>, <span class='object_link'><a href="../../Emma/Debug.html#__debug_session_hash-instance_method" title="Emma::Debug#__debug_session_hash (method)">#__debug_session_hash</a></span></p>









  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Emma/Common.html" title="Emma::Common (module)">Emma::Common</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Emma/Common.html#array_string-instance_method" title="Emma::Common#array_string (method)">#array_string</a></span>, <span class='object_link'><a href="../../Emma/Common.html#boolean%3F-instance_method" title="Emma::Common#boolean? (method)">#boolean?</a></span>, <span class='object_link'><a href="../../Emma/Common.html#build_query_options-instance_method" title="Emma::Common#build_query_options (method)">#build_query_options</a></span>, <span class='object_link'><a href="../../Emma/Common.html#calling_method-instance_method" title="Emma::Common#calling_method (method)">#calling_method</a></span>, <span class='object_link'><a href="../../Emma/Common.html#digits_only%3F-instance_method" title="Emma::Common#digits_only? (method)">#digits_only?</a></span>, <span class='object_link'><a href="../../Emma/Common.html#get_method-instance_method" title="Emma::Common#get_method (method)">#get_method</a></span>, <span class='object_link'><a href="../../Emma/Common.html#get_params-instance_method" title="Emma::Common#get_params (method)">#get_params</a></span>, <span class='object_link'><a href="../../Emma/Common.html#hash_string-instance_method" title="Emma::Common#hash_string (method)">#hash_string</a></span>, <span class='object_link'><a href="../../Emma/Common.html#html_id-instance_method" title="Emma::Common#html_id (method)">#html_id</a></span>, <span class='object_link'><a href="../../Emma/Common.html#inflection-instance_method" title="Emma::Common#inflection (method)">#inflection</a></span>, <span class='object_link'><a href="../../Emma/Common.html#labelize-instance_method" title="Emma::Common#labelize (method)">#labelize</a></span>, <span class='object_link'><a href="../../Emma/Common.html#make_path-instance_method" title="Emma::Common#make_path (method)">#make_path</a></span>, <span class='object_link'><a href="../../Emma/Common.html#named_format_references-instance_method" title="Emma::Common#named_format_references (method)">#named_format_references</a></span>, <span class='object_link'><a href="../../Emma/Common.html#non_breaking-instance_method" title="Emma::Common#non_breaking (method)">#non_breaking</a></span>, <span class='object_link'><a href="../../Emma/Common.html#non_negative-instance_method" title="Emma::Common#non_negative (method)">#non_negative</a></span>, <span class='object_link'><a href="../../Emma/Common.html#normalized_list-instance_method" title="Emma::Common#normalized_list (method)">#normalized_list</a></span>, <span class='object_link'><a href="../../Emma/Common.html#partition_options-instance_method" title="Emma::Common#partition_options (method)">#partition_options</a></span>, <span class='object_link'><a href="../../Emma/Common.html#positive-instance_method" title="Emma::Common#positive (method)">#positive</a></span>, <span class='object_link'><a href="../../Emma/Common.html#quote-instance_method" title="Emma::Common#quote (method)">#quote</a></span>, <span class='object_link'><a href="../../Emma/Common.html#reject_blanks-instance_method" title="Emma::Common#reject_blanks (method)">#reject_blanks</a></span>, <span class='object_link'><a href="../../Emma/Common.html#sanitized_string-instance_method" title="Emma::Common#sanitized_string (method)">#sanitized_string</a></span>, <span class='object_link'><a href="../../Emma/Common.html#strip_quotes-instance_method" title="Emma::Common#strip_quotes (method)">#strip_quotes</a></span>, <span class='object_link'><a href="../../Emma/Common.html#url_escape-instance_method" title="Emma::Common#url_escape (method)">#url_escape</a></span>, <span class='object_link'><a href="../../Emma/Common.html#url_query-instance_method" title="Emma::Common#url_query (method)">#url_query</a></span></p>









  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Emma/Json.html" title="Emma::Json (module)">Emma::Json</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Emma/Json.html#json_parse-instance_method" title="Emma::Json#json_parse (method)">#json_parse</a></span>, <span class='object_link'><a href="../../Emma/Json.html#pretty_json-instance_method" title="Emma::Json#pretty_json (method)">#pretty_json</a></span>, <span class='object_link'><a href="../../Emma/Json.html#safe_json_parse-instance_method" title="Emma::Json#safe_json_parse (method)">#safe_json_parse</a></span></p>



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="normalize_parameters-class_method">

    .<strong>normalize_parameters</strong>(params)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{Symbol=&gt;*}</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>normalize_parameters</p>

<p>â€“ noinspection RubyNilAnalysis ++</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>params</span>


        <span class='type'>(<tt>ActionController::Parameters</tt>, <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>, <tt>Rack::Request</tt>, <tt>nil</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{Symbol=&gt;*}</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


985
986
987
988
989
990</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 985</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_normalize_parameters'>normalize_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span>      <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_to_unsafe_h'>to_unsafe_h</span> <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:to_unsafe_h</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_symbolize_keys'>symbolize_keys</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="stored_auth-class_method">

    .<strong>stored_auth</strong>(refresh = false)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>Table of user names/tokens acquired for use in non-production deploys.</p>

<p>Token are taken from the User table entries that have an :access_token value.  If BOOKSHARE_TEST_USERS is supplied, it is used to prime (or update) database table.</p>

<h2 id="label-Usage+Notes">Usage Notes</h2>

<p>Because the logic is only performed once, direct changes to the User table will not be reflected here, however changes made indirectly via #stored_auth_update will change both the value returned by this method and the associated User table entry.</p>

<p>â€“ noinspection RubyClassVariableUsageInspection ++</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>refresh</span>


        <span class='type'>(<tt><span class='object_link'><a href="../../top-level-namespace.html#Boolean-constant" title="Boolean (constant)">Boolean</a></span></tt>)</span>


        <em class="default">(defaults to: <tt>false</tt>)</em>


        &mdash;
        <div class='inline'>
<p>If <strong>true</strong>, re-read the database.</p>
</div>

    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1076
1077
1078
1079
1080
1081
1082</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 1076</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='lparen'>(</span><span class='id identifier rubyid_refresh'>refresh</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='cvar'>@@stored_auth</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_refresh'>refresh</span>
  <span class='cvar'>@@stored_auth</span> <span class='op'>||=</span>
    <span class='const'><span class='object_link'><a href="../../User.html" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='period'>.</span><span class='id identifier rubyid_not'>not</span><span class='lparen'>(</span><span class='label'>access_token:</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span>
      <span class='lbracket'>[</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='id identifier rubyid_stored_auth_entry'>stored_auth_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_access_token'>access_token</span><span class='rparen'>)</span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="stored_auth_entry-class_method">

    .<strong>stored_auth_entry</strong>(token)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{Symbol=&gt;String}</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>Produce a stored_auth table entry value.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>token</span>


        <span class='type'>(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{Symbol=&gt;String}</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1146
1147
1148</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 1146</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_stored_auth_entry'>stored_auth_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='lbrace'>{</span> <span class='label'>access_token:</span> <span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='label'>token_type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>bearer</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>scope:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>basic</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="stored_auth_update-class_method">


      <span class="overload">.<strong>stored_auth_update</strong>(auth)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt> </span>

      <span class="overload">.<strong>stored_auth_update</strong>(auth)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt> </span>






</h3><div class="docstring">
  <div class="discussion">

<p>Add or update a user name/token entry.</p>

<p>If input parameters were invalid then no change will be made.</p>

<h2 id="label-Variations">Variations</h2>


  </div>
</div>
<div class="tags">

  <p class="tag_title">Overloads:</p>
  <ul class="overload">


      <li class="overload_item">
        <span class="signature">.<strong>stored_auth_update</strong>(auth)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt> </span>
        <div class="docstring">
  <div class="discussion">


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>auth</span>


        <span class='type'>(<tt>OmniAuth::AuthHash</tt>)</span>



        &mdash;
        <div class='inline'>
<p>User/token to add</p>
</div>

    </li>

</ul>


</div>
      </li>


      <li class="overload_item">
        <span class="signature">.<strong>stored_auth_update</strong>(auth)  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt> </span>
        <div class="docstring">
  <div class="discussion">


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>uid</span>


        <span class='type'>(<tt>String</tt>)</span>



        &mdash;
        <div class='inline'>
<p>User to add.</p>
</div>

    </li>

    <li>

        <span class='name'>token</span>


        <span class='type'>(<tt>String</tt>, <tt>::OAuth2::AccessToken</tt>)</span>



        &mdash;
        <div class='inline'>
<p>Associated token.</p>
</div>

    </li>

</ul>


</div>
      </li>

  </ul>
<p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>uid</span>


        <span class='type'>(<tt>OmniAuth::AuthHash</tt>, <tt>String</tt>)</span>



    </li>

    <li>

        <span class='name'>token</span>


        <span class='type'>(<tt>String</tt>, <tt>::OAuth2::AccessToken</tt>, <tt>nil</tt>)</span>


        <em class="default">(defaults to: <tt>nil</tt>)</em>


    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{String=&gt;<span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>}</tt>)</span>



        &mdash;
        <div class='inline'>
<p>The updated set of saved user/tokens.</p>
</div>

    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 1102</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_stored_auth_update'>stored_auth_update</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_auth'>auth</span> <span class='op'>=</span> <span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span><span class='op'>::</span><span class='const'>AuthHash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_auth'>auth</span><span class='period'>.</span><span class='id identifier rubyid_uid'>uid</span><span class='comma'>,</span> <span class='id identifier rubyid_auth'>auth</span><span class='period'>.</span><span class='id identifier rubyid_credentials'>credentials</span><span class='period'>.</span><span class='id identifier rubyid_token'>token</span><span class='rbracket'>]</span>
  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_atoken'>atoken</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../OAuth2.html" title="OAuth2 (module)">OAuth2</a></span></span><span class='op'>::</span><span class='const'>AccessToken</span><span class='rparen'>)</span>
    <span class='comment'># noinspection RubyNilAnalysis
</span>    <span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='id identifier rubyid_atoken'>atoken</span><span class='period'>.</span><span class='id identifier rubyid_token'>token</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>||</span> <span class='id identifier rubyid_token'>token</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#Log-constant" title="Log (constant)">Log</a></span></span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='words_beg'>%W(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='words_sep'> </span><span class='tstring_content'>missing</span><span class='tstring_end'>)</span></span>
      <span class='id identifier rubyid_msg'>msg</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uid</span><span class='tstring_end'>&#39;</span></span>   <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
      <span class='id identifier rubyid_msg'>msg</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>and</span><span class='tstring_end'>&#39;</span></span>   <span class='kw'>if</span> <span class='id identifier rubyid_uid'>uid</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_token'>token</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
      <span class='id identifier rubyid_msg'>msg</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>token</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_token'>token</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
      <span class='id identifier rubyid_msg'>msg</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='comment'># Create or update the dynamic table entry.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='lbracket'>[</span><span class='id identifier rubyid_uid'>uid</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='comment'># noinspection RubyYardParamTypeMatch
</span>    <span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='lbracket'>[</span><span class='id identifier rubyid_uid'>uid</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_stored_auth_entry'>stored_auth_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_token'>token</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='lbracket'>[</span><span class='id identifier rubyid_uid'>uid</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:access_token</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_token'>token</span>
    <span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='lbracket'>[</span><span class='id identifier rubyid_uid'>uid</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:access_token</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='comment'># Update the database table if there was a change.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_token'>token</span>
    <span class='const'><span class='object_link'><a href="../../User.html" title="User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find_or_create_by'>find_or_create_by</span><span class='lparen'>(</span><span class='label'>email:</span> <span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_u'>u</span><span class='op'>|</span> <span class='id identifier rubyid_u'>u</span><span class='period'>.</span><span class='id identifier rubyid_access_token'>access_token</span> <span class='op'>=</span> <span class='id identifier rubyid_token'>token</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Return with the relevant entry.
</span>  <span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='period'>.</span><span class='id identifier rubyid_slice'>slice</span><span class='lparen'>(</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="synthetic_auth_hash-class_method">


      <span class="overload">.<strong>synthetic_auth_hash</strong>(id, token = nil)  &#x21d2; <tt>OmniAuth::AuthHash</tt><sup>?</sup> </span>

      <span class="overload">.<strong>synthetic_auth_hash</strong>(params)  &#x21d2; <tt>OmniAuth::AuthHash</tt><sup>?</sup> </span>






</h3><div class="docstring">
  <div class="discussion">

<p>Generate an auth hash based on fixed information.</p>

<h2 id="label-Variations">Variations</h2>

<p>â€“ noinspection RubyYardParamTypeMatch ++</p>


  </div>
</div>
<div class="tags">

  <p class="tag_title">Overloads:</p>
  <ul class="overload">


      <li class="overload_item">
        <span class="signature">.<strong>synthetic_auth_hash</strong>(id, token = nil)  &#x21d2; <tt>OmniAuth::AuthHash</tt><sup>?</sup> </span>
        <div class="docstring">
  <div class="discussion">


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>id</span>


        <span class='type'>(<tt>String</tt>)</span>



        &mdash;
        <div class='inline'>
<p>Bookshare user identity (email address).</p>
</div>

    </li>

    <li>

        <span class='name'>token</span>


        <span class='type'>(<tt>String</tt>)</span>


        <em class="default">(defaults to: <tt>nil</tt>)</em>


        &mdash;
        <div class='inline'>
<p>Default from #stored_auth.</p>
</div>

    </li>

</ul>


</div>
      </li>


      <li class="overload_item">
        <span class="signature">.<strong>synthetic_auth_hash</strong>(params)  &#x21d2; <tt>OmniAuth::AuthHash</tt><sup>?</sup> </span>
        <div class="docstring">
  <div class="discussion">


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>params</span>


        <span class='type'>(<tt>ActionController::Parameters</tt>, <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>



    </li>

</ul>




    <p class="tag_title">Options Hash (<tt>params</tt>):</p>
    <ul class="option">

        <li>
          <span class="name">:auth</span>
          <span class="type">(<tt>OmniAuth::AuthHash</tt>)</span>
          <span class="default">

          </span>

        </li>

        <li>
          <span class="name">:uid</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">

          </span>

        </li>

        <li>
          <span class="name">:id</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">

          </span>

            &mdash; <div class='inline'>
<p>Alias for :uid.</p>
</div>

        </li>

        <li>
          <span class="name">:access_token</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">

          </span>

        </li>

        <li>
          <span class="name">:token</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">

          </span>

            &mdash; <div class='inline'>
<p>Alias for :access_token.</p>
</div>

        </li>

    </ul>



</div>
      </li>

  </ul>
<p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class='name'>id</span>


        <span class='type'>(<tt>ActionController::Parameters</tt>, <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>, <tt>String</tt>)</span>



    </li>

    <li>

        <span class='name'>token</span>


        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>


        <em class="default">(defaults to: <tt>nil</tt>)</em>


    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt>OmniAuth::AuthHash</tt>, <tt>nil</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 1016</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_synthetic_auth_hash'>synthetic_auth_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_token'>token</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_abort'>abort</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'>: id must be a string</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span><span class='op'>::</span><span class='const'>AuthHash</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_id'>id</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
    <span class='comment'># Lookup token below.
</span>  <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_prm'>prm</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_parameters'>normalize_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='symbol'>:auth</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span><span class='op'>::</span><span class='const'>AuthHash</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_prm'>prm</span><span class='lbracket'>[</span><span class='symbol'>:auth</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_id'>id</span>    <span class='op'>=</span> <span class='id identifier rubyid_prm'>prm</span><span class='lbracket'>[</span><span class='symbol'>:uid</span><span class='rbracket'>]</span>          <span class='op'>||</span> <span class='id identifier rubyid_prm'>prm</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='id identifier rubyid_prm'>prm</span><span class='lbracket'>[</span><span class='symbol'>:access_token</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_prm'>prm</span><span class='lbracket'>[</span><span class='symbol'>:token</span><span class='rbracket'>]</span> <span class='comment'># or lookup token below
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_token'>token</span> <span class='op'>||=</span> <span class='id identifier rubyid_stored_auth'>stored_auth</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='symbol'>:access_token</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span><span class='op'>::</span><span class='const'>AuthHash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='label'>provider:</span>    <span class='id identifier rubyid_default_options'>default_options</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>uid:</span>         <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
    <span class='label'>info:</span>        <span class='lbrace'>{</span> <span class='label'>email:</span> <span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_stringify_keys'>stringify_keys</span><span class='comma'>,</span>
    <span class='label'>credentials:</span> <span class='lbrace'>{</span> <span class='label'>token:</span> <span class='id identifier rubyid_token'>token</span><span class='comma'>,</span> <span class='label'>expires:</span> <span class='kw'>false</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_stringify_keys'>stringify_keys</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="authorize_params-instance_method">

    #<strong>authorize_params</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>





</h3><div class="docstring">
  <div class="discussion">

<p>authorize_params</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


717
718
719
720
721</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 717</span>

<span class='kw'>def</span> <span class='id identifier rubyid_authorize_params'>authorize_params</span>
  <span class='kw'>super</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='op'>|</span>
    <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH-BOOKSHARE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="call_app!-instance_method">

    #<strong>call_app!</strong>(env = @env)  &#x21d2; <tt>*</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>call_app!</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt>*</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


540
541
542
543</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 540</span>

<span class='kw'>def</span> <span class='id identifier rubyid_call_app!'>call_app!</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span> <span class='op'>=</span> <span class='ivar'>@env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___debug_items'>__debug_items</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_env'>env</span> <span class='rbrace'>}</span>
  <span class='kw'>super</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="callback_call-instance_method">

    #<strong>callback_call</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>





</h3><div class="docstring">
  <div class="discussion">

<p>Performs the steps necessary to run the callback phase of a strategy.</p>


  </div>
</div>
<div class="tags">


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


291
292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 291</span>

<span class='kw'>def</span> <span class='id identifier rubyid_callback_call'>callback_call</span>
  <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>super</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="callback_phase-instance_method">

    #<strong>callback_phase</strong>  &#x21d2; <tt>(Integer, Rack::Utils::HeaderHash, Rack::BodyProxy)</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>callback_phase</p>

<p>â€“ noinspection RubyScope ++</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt>(Integer, Rack::Utils::HeaderHash, Rack::BodyProxy)</tt>)</span>



    </li>

</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">

    <li>


        <span class='type'>(<tt>OmniAuth::Strategies::OAuth2::CallbackError</tt>)</span>



    </li>

    <li>


        <span class='type'>(<tt>OAuth2::Error</tt>)</span>



    </li>

    <li>


        <span class='type'>(<tt>Timeout::Error</tt>)</span>



    </li>

    <li>


        <span class='type'>(<tt>Errno::ETIMEDOUT</tt>)</span>



    </li>

    <li>


        <span class='type'>(<tt>SocketError</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 746</span>

<span class='kw'>def</span> <span class='id identifier rubyid_callback_phase'>callback_phase</span>
  <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span><span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH-BOOKSHARE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>error_reason</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>error</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># Raise an exception if the response indicated an error.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_e_type'>e_type</span>
    <span class='id identifier rubyid_description'>description</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>error_description</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>error_reason</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>CallbackError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_e_type'>e_type</span><span class='comma'>,</span> <span class='id identifier rubyid_description'>description</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>error_uri</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Raise an exception if the returned state doesn&#39;t match.
</span>  <span class='comment'># noinspection RubyResolve
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_provider_ignores_state'>provider_ignores_state</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>state</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>omniauth.state</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>=</span> <span class='symbol'>:csrf_detected</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>CallbackError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_e_type'>e_type</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CSRF detected</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># noinspection RubyStringKeysInHashInspection
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span>
    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_op'>op</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_parameters'>normalize_parameters</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:commit</span><span class='rparen'>)</span>
      <span class='comment'># Special case for locally-provided uid/token causes a redirect to
</span>      <span class='comment'># the special endpoint for direct token sign-in.
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_access_token'>access_token</span>        <span class='op'>=</span> <span class='id identifier rubyid_synthetic_access_token'>synthetic_access_token</span><span class='lparen'>(</span><span class='id identifier rubyid_op'>op</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>omniauth.auth</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_synthetic_auth_hash'>synthetic_auth_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_op'>op</span><span class='rparen'>)</span>
      <span class='lbracket'>[</span><span class='int'>302</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Location</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/users/sign_in_as</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rbracket'>]</span>

    <span class='kw'>elsif</span> <span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span><span class='op'>&amp;.</span><span class='id identifier rubyid_uid'>uid</span><span class='rparen'>)</span>
      <span class='comment'># Special case for a fixed user causes a redirect to the special
</span>      <span class='comment'># endpoint for direct sign-in.
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_access_token'>access_token</span>        <span class='op'>=</span> <span class='id identifier rubyid_synthetic_access_token'>synthetic_access_token</span><span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>omniauth.auth</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_synthetic_auth_hash'>synthetic_auth_hash</span><span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span><span class='rparen'>)</span>
      <span class='lbracket'>[</span><span class='int'>302</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Location</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/users/sign_in_as?id=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_username'>username</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rbracket'>]</span>

    <span class='kw'>else</span>
      <span class='comment'># Normal case results in a call to the remote service.
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_access_token'>access_token</span> <span class='op'>=</span> <span class='id identifier rubyid_build_access_token'>build_access_token</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_access_token'>access_token</span> <span class='op'>=</span> <span class='id identifier rubyid_access_token'>access_token</span><span class='period'>.</span><span class='id identifier rubyid_refresh!'>refresh!</span> <span class='kw'>if</span> <span class='id identifier rubyid_access_token'>access_token</span><span class='period'>.</span><span class='id identifier rubyid_expired?'>expired?</span>
      <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>omniauth.auth</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_auth_hash'>auth_hash</span>
      <span class='id identifier rubyid_call_app!'>call_app!</span>

    <span class='kw'>end</span>

<span class='kw'>rescue</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../OAuth2.html" title="OAuth2 (module)">OAuth2</a></span></span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='const'>CallbackError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
  <span class='id identifier rubyid___debug_line'>__debug_line</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INVALID</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>||=</span> <span class='symbol'>:invalid_credentials</span>

<span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>Timeout</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='op'>::</span><span class='const'>Errno</span><span class='op'>::</span><span class='const'>ETIMEDOUT</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
  <span class='id identifier rubyid___debug_line'>__debug_line</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TIMEOUT</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>=</span> <span class='symbol'>:timeout</span>

<span class='kw'>rescue</span> <span class='op'>::</span><span class='const'>SocketError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
  <span class='id identifier rubyid___debug_line'>__debug_line</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CONNECT</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>=</span> <span class='symbol'>:failed_to_connect</span>

<span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_error'>error</span>
  <span class='id identifier rubyid___debug_line'>__debug_line</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EXCEPTION</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>=</span> <span class='symbol'>:unexpected_error</span>

<span class='kw'>ensure</span>
  <span class='id identifier rubyid_fail!'>fail!</span><span class='lparen'>(</span><span class='id identifier rubyid_e_type'>e_type</span><span class='comma'>,</span> <span class='id identifier rubyid_error'>error</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_e_type'>e_type</span> <span class='op'>||</span> <span class='id identifier rubyid_error'>error</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="client-instance_method">

    #<strong>client</strong>  &#x21d2; <tt>::OAuth2::Client</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>The OAuth2 client instance.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt>::OAuth2::Client</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


683
684
685
686
687
688
689
690
691
692
693
694</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 683</span>

<span class='kw'>def</span> <span class='id identifier rubyid_client'>client</span>
  <span class='comment'># noinspection RubyResolve
</span>  <span class='ivar'>@client</span> <span class='op'>||=</span>
    <span class='op'>::</span><span class='const'><span class='object_link'><a href="../../OAuth2.html" title="OAuth2 (module)">OAuth2</a></span></span><span class='op'>::</span><span class='const'>Client</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
      <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_client_id'>client_id</span><span class='comma'>,</span>
      <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_client_secret'>client_secret</span><span class='comma'>,</span>
      <span class='id identifier rubyid_deep_symbolize'>deep_symbolize</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_client_options'>client_options</span><span class='rparen'>)</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='op'>|</span>
      <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:redirect_uri</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id identifier rubyid_callback_url'>callback_url</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\?.*</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH-BOOKSHARE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="log-instance_method">

    #<strong>log</strong>(level, message)  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>





</h3><div class="docstring">
  <div class="discussion">

<p>Direct access to the OmniAuth logger, automatically prefixed with this strategy&#39;s name.</p>

<h2 id="label-Implementation+Notes">Implementation Notes</h2>

<p>Instead of attempting to  override Configuration#default_logger this override simply manages its own logger instance</p>


  </div>
</div>
<div class="tags">


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


178
179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 178</span>

<span class='kw'>def</span> <span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='id identifier rubyid_level'>level</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='ivar'>@log</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#Log-constant" title="Log (constant)">Log</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>STDERR</span><span class='rparen'>)</span>
  <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../top-level-namespace.html#Log-constant" title="Log (constant)">Log</a></span></span><span class='period'>.</span><span class='id identifier rubyid_log_level'>log_level</span><span class='lparen'>(</span><span class='id identifier rubyid_level'>level</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>omniauth: (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>) </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="raw_info-instance_method">

    #<strong>raw_info</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{Symbol=&gt;<span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span>}</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>Information about the user account.</p>

<h2 id="label-Implementation+Notes">Implementation Notes</h2>

<p>NOTE: Needs to relate to: E.g.:</p>

<p>Hash[</p>

<pre class="code ruby"><code class="ruby">username: &#39;john@smith.com&#39;,
links: [],
name: Hash[
  firstName: &#39;John&#39;,
  lastName:  &#39;Smith&#39;,
  middle:    nil,
  prefix:    nil,
  suffix:    nil,
  links:     []
]
</code></pre>

<p>]</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span>{Symbol=&gt;<span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span>}</tt>)</span>



    </li>

</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">

      <li>BookshareService::UserAccount#get_user_identity</li>

  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 110</span>

<span class='kw'>def</span> <span class='id identifier rubyid_raw_info'>raw_info</span>
  <span class='ivar'>@raw_info</span> <span class='op'>||=</span>
    <span class='id identifier rubyid_access_token'>access_token</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>BOOKSHARE_BASE_URL</span><span class='embexpr_end'>}</span><span class='tstring_content'>/me</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_parsed'>parsed</span>
      <span class='period'>.</span><span class='id identifier rubyid_deep_symbolize_keys'>deep_symbolize_keys</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="request_call-instance_method">

    #<strong>request_call</strong>  &#x21d2; <tt>(Integer, Rack::Utils::HeaderHash, Rack::BodyProxy)</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>Performs the steps necessary to run the request phase of a strategy.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt>(Integer, Rack::Utils::HeaderHash, Rack::BodyProxy)</tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 243</span>

<span class='kw'>def</span> <span class='id identifier rubyid_request_call'>request_call</span>
  <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span><span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH-BOOKSHARE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_setup_phase'>setup_phase</span>
  <span class='id identifier rubyid_log'>log</span> <span class='symbol'>:info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Request phase initiated.</span><span class='tstring_end'>&#39;</span></span>

  <span class='comment'># Store query params to be passed back via #callback_call.
</span>  <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>omniauth.params</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_parameters'>normalize_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___debug_items'>__debug_items</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='lbrace'>{</span> <span class='label'>options:</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='label'>session:</span> <span class='id identifier rubyid___debug_session_hash'>__debug_session_hash</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># noinspection RubyResolve
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:commit</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_log'>log</span> <span class='symbol'>:info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>By-passing request_phase (local developer uid/token)</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_authorize_params'>authorize_params</span> <span class='comment'># Generate session[&#39;omniauth.state&#39;]
</span>    <span class='id identifier rubyid_callback_call'>callback_call</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_current_user'>current_user</span>
    <span class='id identifier rubyid_log'>log</span> <span class='symbol'>:info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>By-passing request_phase (configured uid/token)</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_authorize_params'>authorize_params</span> <span class='comment'># Generate session[&#39;omniauth.state&#39;]
</span>    <span class='id identifier rubyid_callback_call'>callback_call</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_form'>form</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:call</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_log'>log</span> <span class='symbol'>:info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Rendering form from supplied Rack endpoint.</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_form'>form</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_form'>form</span>
    <span class='id identifier rubyid_log'>log</span> <span class='symbol'>:info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Rendering form from underlying application.</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_call_app!'>call_app!</span>

  <span class='kw'>elsif</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_origin_param'>origin_param</span>
    <span class='id identifier rubyid_org'>org</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_origin_param'>origin_param</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_presence'>presence</span>
    <span class='id identifier rubyid_ref'>ref</span> <span class='op'>=</span> <span class='id identifier rubyid_env'>env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_REFERER</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_presence'>presence</span>
    <span class='id identifier rubyid_ref'>ref</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_ref'>ref</span><span class='op'>&amp;.</span><span class='id identifier rubyid_end_with?'>end_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_request_path'>request_path</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_org'>org</span> <span class='op'>||</span> <span class='id identifier rubyid_ref'>ref</span>
      <span class='id identifier rubyid_log'>log</span> <span class='symbol'>:info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Origin from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_org'>org</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>request.params</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HTTP_REFERER</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>omniauth.origin</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_org'>org</span> <span class='op'>||=</span> <span class='id identifier rubyid_ref'>ref</span>
    <span class='id identifier rubyid___debug_line'>__debug_line</span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>session[&#39;omniauth.origin&#39;] = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_org'>org</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_request_phase'>request_phase</span>

  <span class='kw'>else</span>
    <span class='id identifier rubyid_request_phase'>request_phase</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="request_phase-instance_method">

    #<strong>request_phase</strong>  &#x21d2; <tt>(Integer, Rack::Utils::HeaderHash, Rack::BodyProxy)</tt>





</h3><div class="docstring">
  <div class="discussion">

<p>request_phase</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt>(Integer, Rack::Utils::HeaderHash, Rack::BodyProxy)</tt>)</span>



    </li>

</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">

      <li><span class='object_link'><a href="../../OAuth2/ClientExt.html#request-instance_method" title="OAuth2::ClientExt#request (method)">OAuth2::ClientExt#request</a></span></li>

  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


702
703
704
705
706
707
708
709
710
711</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 702</span>

<span class='kw'>def</span> <span class='id identifier rubyid_request_phase'>request_phase</span>
  <span class='const'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_before_request_phase'>before_request_phase</span><span class='op'>&amp;.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_env'>env</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dbg'>dbg</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH-BOOKSHARE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'> | </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_request_method'>request_method</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_dbg'>dbg</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_auth_code'>auth_code</span>
  <span class='id identifier rubyid_prms'>prms</span> <span class='op'>=</span> <span class='id identifier rubyid_authorize_params'>authorize_params</span>
  <span class='id identifier rubyid_url'>url</span>  <span class='op'>=</span> <span class='id identifier rubyid_code'>code</span><span class='period'>.</span><span class='id identifier rubyid_authorize_url'>authorize_url</span><span class='lparen'>(</span><span class='id identifier rubyid_prms'>prms</span><span class='rparen'>)</span>
  <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dbg'>dbg</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; authorize_url = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="token_params-instance_method">

    #<strong>token_params</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>





</h3><div class="docstring">
  <div class="discussion">

<p>token_params</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>



    </li>

</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


727
728
729
730
731</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ext/omniauth/lib/omniauth/strategies/bookshare.rb', line 727</span>

<span class='kw'>def</span> <span class='id identifier rubyid_token_params'>token_params</span>
  <span class='kw'>super</span><span class='period'>.</span><span class='id identifier rubyid_tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='op'>|</span>
    <span class='id identifier rubyid___debug'><span class='object_link'><a href="../../top-level-namespace.html#__debug-instance_method" title="#__debug (method)">__debug</a></span></span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OMNIAUTH-BOOKSHARE </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid___method__'>__method__</span><span class='embexpr_end'>}</span><span class='tstring_content'> =&gt; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>

</div>

      <div id="footer">
  Generated on Sat Jan 23 11:15:09 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>
